Index: linux-stage/fs/ext3/super.c
===================================================================
--- linux-stage.orig/fs/ext3/super.c	2007-11-26 22:38:34.000000000 +0300
+++ linux-stage/fs/ext3/super.c	2007-11-26 22:47:17.000000000 +0300
@@ -3230,6 +3230,7 @@ EXPORT_SYMBOL(d_genocide);
 	.fs_flags	= FS_REQUIRES_DEV,
 };
 
+extern void dynlock_cache_init(void);
 static int __init init_ext3_fs(void)
 {
 	int err;
@@ -3244,6 +3245,7 @@
 	err = init_inodecache();
 	if (err)
 		goto out1;
+	dynlock_cache_init();
         err = register_filesystem(&ext3_fs_type);
 	if (err)
 		goto out;
@@ -3256,9 +3257,11 @@ EXPORT_SYMBOL(d_genocide);
 	return err;
 }
 
+extern void dynlock_cache_exit(void);
 static void __exit exit_ext3_fs(void)
 {
 	unregister_filesystem(&ext3_fs_type);
+	dynlock_cache_exit();
 	destroy_inodecache();
 	exit_ext3_xattr();
 	exit_ext3_proc();
Index: linux-stage/fs/ext3/Makefile
===================================================================
--- linux-stage.orig/fs/ext3/Makefile	2007-11-26 22:38:32.000000000 +0300
+++ linux-stage/fs/ext3/Makefile	2007-11-26 22:47:52.000000000 +0300
@@ -5,7 +5,8 @@
 obj-$(CONFIG_EXT3_FS) += ext3.o
 
 ext3-y	:= balloc.o bitmap.o dir.o file.o fsync.o ialloc.o inode.o iopen.o \
-	   ioctl.o namei.o super.o symlink.o hash.o resize.o extents.o mballoc.o
+	   ioctl.o namei.o super.o symlink.o hash.o resize.o extents.o \
+	   mballoc.o dynlocks.o
 
 ext3-$(CONFIG_EXT3_FS_XATTR)	 += xattr.o xattr_user.o xattr_trusted.o
 ext3-$(CONFIG_EXT3_FS_POSIX_ACL) += acl.o
