default: all

MODULES := ldiskfs

# copy makefile over to not break patches
ext3_extra := $(wildcard @LINUX@/fs/ext3/Makefile)

ext3_headers := $(wildcard @LINUX@/fs/ext3/*.h)
linux_headers := $(wildcard @LINUX@/include/linux/ext3*.h)

ext3_sources := $(filter-out %.mod.c,$(wildcard @LINUX@/fs/ext3/*.c))
new_sources := iopen.c iopen.h
ldiskfs_sources := $(notdir $(ext3_sources) $(ext3_headers)) $(new_sources)

ldiskfs-objs := $(filter %.o,$(ldiskfs_sources:.c=.o))

EXTRA_PRE_CFLAGS := -I@LINUX@/fs -I@LUSTRE@ -I@LUSTRE@/ldiskfs

@INCLUDE_RULES@
