.TH lconf 1 "2004 Sep 16" Lustre "configuration utilities"
.SH NAME
lconf \- Lustre filesystem configuration utility
.SH SYNOPSIS
.br
.B lconf
[OPTIONS] <XML-config file>
.br
.SH DESCRIPTION
.B lconf
, when invoked configures a node following directives in the
<XML-config-file>.Can be used to control recovery and startup/shutdown
. There will be single configuration file for all the nodes in a
single cluster. This file should be distributed to all the nodes in
the cluster or kept in a location accessible to all the nodes. The XML file must be specified. When invoked with no options, lconf will attempt to configure the resources owned by the node it is invoked on
.PP
The arguments that can be used for lconf are:
.PP
.TP
--abort_recovery - Used to start Lustre when you are certian that
recovery will not succeed, as when an OST or MDS is disabled. 
.TP
--acl Enable Access Control List support on the MDS 
.TP
--allow_unprivileged_port Allows connections from unprivileged ports
.TP
--clientoptions <options> 
Additional options for mounting Lustre clients. Obsolete with
zeroconfig mounting..
.TP
--client_uuid <uuid> 
The failed client (required for recovery).
.TP
--clumanager Generate a Red Hat Clumanager configuration file for this
node.
.TP
--config <arg> 
Cluster configuration name used for LDAP query (depreciated)
.TP
--conn_uuid <uuid> 
The failed connection (required for recovery).
.TP
-d|--cleanup 
Unconfigure a node. The same config and --node argument used for configuration needs to be used for cleanup as well. This will attempt to undo all of the configuration steps done by lconf, including unloading the kernel modules.
.TP
--debug_path <path> 
Path to save debug dumps.(default is /tmp/lustre-log)
.TP
--dump <file> 
Dump the kernel debug log to the specified file before portals is unloaded during cleanup.
.TP
--failover 
Used to shutdown without saving state. This will allow the node to give up service to another node for failover purposes. This will not be a clean shutdown.
.TP
-f|--force 
Forced unmounting and/or obd detach during cleanup. 
.TP
--gdb 
Causes lconf to create a gdb module script and pause 5 seconds before doing any Lustre configuration (the gdb module script is always created, however).
.TP
--gdb_script <arg> 
Full name of gdb debug script. Default is /tmp/ogdb.
.TP
--group <arg> 
The group of devices to cleanup/configure.
.TP
--group_upcall <arg> 
Pathname to the MDS upcall to resolve secondary group membership.  Defaults to NONE, meaning that the MDS will use whatever group the client supplies, but this is limited to a single supplementary group.
.TP
-h,--help 
Print help.
.TP
--inactive <UUID> 
The UUID of the service to be ignored by a client mounting Lustre. Allows the client to mount in the presence of some inactive services. (currently OST only). Multiple UUIDs can be specified by repeating the option. 
.TP
--lctl-dump <arg> 
Dump all ioctls to the specified file
.TP
--ldapurl <arg> 
LDAP server URL. Depreciated
.TP
--lustre=src_dir 
Specify the base directory for Lustre sources, this parameter will cause lconf to load the lustre modules from this source tree.
.TP
--lustre_upcall <path> 
Set the location of the Lustre upcall scripts used by the client for recovery
.TP
--make_service_scripts Create per-service symlinks for use with clumanager HA software
.TP
--mds_ost_conn 
Open connections to OSTs on MDS.
.TP
--maxlevel <level> 
Perform configuration of devices and services up to level given. When
used in conjunction with cleanup, services are torn down up to a
certain level.
Levels are aproximatly like:
10 - network
20 - device, ldlm
30 - osd, mdd
40 - mds, ost
70 - mountpoint, echo_client, osc, mdc, lov
.TP
--minlevel <level> 
Specify the minimum level of services to configure/cleanup. Default is 0.
.TP
--mkfsoptions <options> 
Specify additional options for the mk*fs command line.
.TP
--mountfsoptions <options> 
Specify additional options for mount fs command line. Mount options will be passed by this argument. For example, extents are to be enabled by adding ",extents" to the --mountfsoptions option. "errors=remount-ro" and "asyncdel" can also be added to it.
.TP
--node node_name 
Specify a specific node to configure. By default, lconf will search for nodes with the local hostname and 'localhost'. When --node is used, only node_name is searched for. If a matching node is not found in the config, then lconf exits with an error.
.TP
--noexec,-n 
Print, but don't execute, the steps lconf will perform. This is useful for debugging a configuration, and when used with --node, can be run on any host.
.TP
--nomod 
Only setup devices and services, do not load modules.
.TP
--nosetup 
Only load modules, do not configure devices or services.
.TP
--old_conf Start up service even though config logs appear outdated.
.TP
--portals <path> 
Specify portals source directory. If this is a relative path, then it
is assumed to be relative to lustre. (Depreciated)
.TP
--portals_upcall <path> 
Specify the location of the Portals upcall scripts used by the client
for recovery (Depreciated)
.TP
--ptldebug debug-level 
This options can be used to set the required debug level.
.TP
--quota 
Enable quota support for client filesystem
.TP
--rawprimary <arg>  For clumanager, device of the primary quorum
(default=/dev/raw/raw1)
.TP
--rawsecondary <arg>  For clumanager, device of the secondary quorum (default=/dev/raw/raw2)
.TP
--record 
Write config information on mds.
.TP
--record_device <arg> 
Specify MDS device name that will record the config commands.
.TP
--record_log <arg> 
Specify the name of config record log.
.TP
--recover <arg> 
Recover a device.
.TP
--reformat 
Reformat all the devices. This is essential on the first time the file system is brought up.
.TP
--select <arg> 
Select a particular node for a service 
.TP
--service <arg>
Shorthand for --group <arg> --select <arg>=<hostname>
.TP
--service_scripts <arg>  For clumanager, directory containing per-service scripts (default=/etc/lustre/services)
.TP
--single_socket The socknal option. Uses only one socket instead of a
bundle.
.TP
--subsystem <arg> 
Set the portals debug subsystem.
.TP
--tgt_uuid <uuid> 
Specify the failed target (required for recovery).
.TP
--timeout <arg> 
Set the recovery timeout period.
.TP
--upcall <path> 
Set the location of both Lustre and Portals upcall scripts used by the
client for recovery
.TP
--user_xattr Enable user_xattr support on MDS
.TP
--verbose,-v 
Be verbose and show actions while going along.
.TP
--write_conf 
Save all client configuration information on the MDS
.SH EXAMPLES
.TP
.B lconf --node client config.xml
This invokes lconf on the client node.
.TP
.B lconf --ptldebug "~(portals | malloc | trace)"
Used to set the required debug levels (all but these).
.TP
.B lconf --ptldebug "ldlm|ha"
Used to turn-on specific debug types.
.TP
.B lconf --inactive OST_ost1_UUID --inactive OST_ost2_UUID config.xml
A subset of failed OSTs can be ignored during Lustre mount on the clients by using this option. Here OST1 and OST2 have failed and need to be ignored.
.SH BUGS
None are known.
