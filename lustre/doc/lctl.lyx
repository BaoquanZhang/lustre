#LyX 1.2 created this file. For more info see http://www.lyx.org/
\lyxformat 220
\textclass amsart-plain
\language english
\inputencoding auto
\fontscheme times
\graphics default
\paperfontsize default
\spacing single 
\papersize letterpaper
\paperpackage a4
\use_geometry 0
\use_amsmath 0
\use_natbib 0
\use_numerical_citations 0
\paperorientation portrait
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip medskip
\quotes_language english
\quotes_times 2
\papercolumns 1
\papersides 1
\paperpagestyle default

\layout Section

lctl
\layout Subsection

NAME 
\layout Description

lctl Low level Lustre filesystem configuration utility.
\layout Subsection

SYNOPSIS
\layout Standard


\series bold 
\emph on 
\SpecialChar ~

\newline 
lctl 
\layout Standard


\series bold 
\emph on 
lctl\SpecialChar ~
--device\SpecialChar ~
<devno> <command\SpecialChar ~
[args]>
\layout Standard


\series bold 
\emph on 
lctl\SpecialChar ~
--threads\SpecialChar ~
<numthreads>\SpecialChar ~
<verbose>\SpecialChar ~
<devno>\SpecialChar ~
<command [args]>
\layout Subsection

DESCRIPTION
\layout Standard

The program can be invoked in interactive mode by issuing 
\series bold 
lctl.

\series default 
 After that, commands are issued as below.
 The most common commands in lctl are (in matching pairs) 
\family typewriter 
\size small 
device
\family default 
\size default 
 and 
\family typewriter 
\size small 
attach
\family default 
\size default 
, 
\family typewriter 
\size small 
detach
\family default 
\size default 
 and 
\family typewriter 
\size small 
setup
\family default 
\size default 
, 
\family typewriter 
\size small 
cleanup
\family default 
\size default 
 and 
\family typewriter 
\size small 
connect
\family default 
\size default 
, 
\family typewriter 
\size small 
disconnect
\family default 
\size default 
 and 
\family typewriter 
\size small 
help
\family default 
\size default 
, and 
\family typewriter 
\size small 
quit
\family default 
\size default 
.
 To get a complete listing of available commands, type 
\family typewriter 
\size small 
help
\family default 
\size default 
 at the lctl prompt.
  To get basic help on the meaning and syntax of a command, type 
\family typewriter 
\size small 
help command
\family default 
\size default 
.
  Command completion is activated with the 
\family typewriter 
\size small 
TAB
\family default 
\size default 
 key, and command history is available via the up- and down-arrow keys.
 
\layout Standard

For non-interactive single threaded use, one uses the second invocation,
 which runs 
\emph on 
command
\emph default 
 after connecting to the device
\emph on 
.

\emph default 
 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
--device
\series default 
\emph default 
 The device number to be used for the operation.
 The value of devno is an integer, normally found by calling 
\emph on 
lctl name2dev 
\emph default 
on a device name.
 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
--threads
\series default 
\emph default 
 How many threads should be forked doing the command specified.
 The numthreads variable is a strictly positivie integer indicating how
 many threads should be started.
 Verbose can take values <XXXX>; 
\emph on 
devno 
\emph default 
is used as above.
\layout LyX-Code

\layout LyX-Code

\layout Description

Network\SpecialChar ~
Configuration
\begin_deeper 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
network\SpecialChar ~
<tcp/elans/myrinet>
\series default 
\emph default 
 Indicate what kind of network applies for the configuration commands that
 follow.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
connect\SpecialChar ~
[[<hostname>\SpecialChar ~
<port>]\SpecialChar ~
|\SpecialChar ~
<elan\SpecialChar ~
id>]
\series default 
\emph default 
 This will establish a connection to a remote network network 
\emph on 
id
\emph default 
 given by the hostname/port combination, or the elan 
\emph on 
id
\emph default 
.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
disconnect\SpecialChar ~
<nid>
\series default 
\emph default 
 Disconnect from a remote 
\emph on 
nid
\emph default 
.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
mynid\SpecialChar ~
[nid]
\series default 
\emph default 
 Informs the socknal of the local 
\emph on 
nid
\emph default 
.
 It defaults to hostname for tcp networks and is automatically setup for
 elan/myrinet networks.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
add_uuid\SpecialChar ~
<uuid>\SpecialChar ~
<nid>
\series default 
\emph default 
 Associate a given UUID with an 
\emph on 
nid.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
close_uuid\SpecialChar ~
<uuid>
\series default 
\emph default 
 Disconnect a UUID.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
del_uuid\SpecialChar ~
<uuid>
\series default 
\emph default 
 Delete a UUID association.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
add_route\SpecialChar ~
<gateway>\SpecialChar ~
<target>\SpecialChar ~
[target]
\series default 
\emph default 
 Add an entry to the routing table for the given target.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
del_route\SpecialChar ~
<target>
\series default 
\emph default 
 Delete an entry for the target from the routing table.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
route_list
\series default 
\emph default 
 Print the complete routing table.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
recv_mem\SpecialChar ~
[size]
\series default 
\emph default 
 Set the socket 
\emph on 
receive
\emph default 
 buffer size; if the size is omitted, the default size for the buffer is
 printed.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
send_mem\SpecialChar ~
[size]
\series default 
\emph default 
 Set send buffer size for the socket; if size is omitted, the default size
 for the buffer is printed.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
nagle\SpecialChar ~
[on/off]
\series default 
\emph default 
 Enable/disable nagle; omitting the argument will cause the default value
 to be printed.
\end_deeper 
\layout Description

Device\SpecialChar ~
Selection
\begin_deeper 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
newdev
\series default 
\emph default 
 Create a new device.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
name2dev
\series default 
\emph default 
 This command can be used to determine a device number for the given device
 name.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
device
\series default 
\emph default 
 This will select the specified OBD device.
  All other commands depend on the device being set.
 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
device_list
\series default 
\emph default 
 Show all the devices.
\end_deeper 
\layout Description

Device\SpecialChar ~
Configuration
\begin_deeper 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
attach\SpecialChar ~
type\SpecialChar ~
[name\SpecialChar ~
[uuid]]
\series default 
\emph default 
 
\shape italic 
\emph on 
Attach
\shape default 
\emph default 
 a type to the current device (which you need to set using the 
\family typewriter 
\size small 
device
\family default 
\size default 
 command) and give that device a name and UUID.
  This allows us to identify the device for use later, and also tells us
 what type of device we will have.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
setup\SpecialChar ~
<args...>
\series default 
\emph default 
 Type specific device setup commands.
 For obdfilter, a setup command tells the driver which block device it should
 use for storage and what type of filesystem is on that device.
 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
cleanup
\series default 
\emph default 
 Cleanup a previously setup device.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
detach
\series default 
\emph default 
 Remove driver (and name and UUID) from the current device.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
lov_setconfig\SpecialChar ~
lov-uuid\SpecialChar ~
default-stripe-count\SpecialChar ~
default-stripe-size\SpecialChar ~
offset\SpecialChar ~
pattern\SpecialChar ~
UUID1\SpecialChar ~
[U
UID2...]
\series default 
\emph default 
 Write LOV configuration to an MDS device.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
lov_getconfig\SpecialChar ~
lov-uuid
\series default 
\emph default 
 Read LOV configuration from an MDS device.
 Returns default-stripe-count, default-stripe-size, offset, pattern, and
 a list of OST UUID's.
\end_deeper 
\layout Description

Device\SpecialChar ~
Operations
\begin_deeper 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
probe\SpecialChar ~
[timeout]
\series default 
\emph default 
 Build a connection handle to a device.
 This command is used to suspend configuration until the lctl command has
 ensured that the MDS and OSC services are available.
 This is to avoid mount failures in a rebooting cluster.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
close
\emph default 
 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
getattr\SpecialChar ~
<objid>
\series default 
\emph default 
 Get attributes for an OST object 
\emph on 
<objid>
\emph default 
 .
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
setattr\SpecialChar ~
<objid>\SpecialChar ~
<mode>
\series default 
\emph default 
 Set mode attribute for OST object 
\emph on 
<objid>
\emph default 
.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
create\SpecialChar ~
[num\SpecialChar ~
[mode\SpecialChar ~
[verbose]]]
\series default 
\emph default 
 Create the specified number 
\emph on 
<num>
\emph default 
 of OST objects with the given 
\emph on 
<mode>
\emph default 
.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
destroy\SpecialChar ~
<objid>
\series default 
\emph default 
 Destroy an OST object.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
test_getattr\SpecialChar ~
<num>\SpecialChar ~
[verbose\SpecialChar ~
[[t]objid]]
\series default 
\emph default 
 Do 
\emph on 
<num>
\emph default 
 
\emph on 
getattrs
\emph default 
 on OST object 
\emph on 
<objid>
\emph default 
 (
\emph on 
objectid
\emph default 
+1 on each thread).
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
test_brw\SpecialChar ~
[t]<num>\SpecialChar ~
[write\SpecialChar ~
[verbose\SpecialChar ~
[npages\SpecialChar ~
[[t]objid]]]]
\series default 
\emph default 
 Do 
\emph on 
<num>
\emph default 
 bulk 
\emph on 
read
\emph default 
/
\emph on 
writes
\emph default 
 on OST object 
\emph on 
<objid>
\emph default 
 (
\emph on 
<npages>
\emph default 
 per I/O).
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
test_ldlm
\series default 
\emph default 
 Perform lock manager test.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
ldlm_regress_start\SpecialChar ~
%s\SpecialChar ~
[numthreads\SpecialChar ~
[refheld\SpecialChar ~
[numres\SpecialChar ~
[numext]]]]
\series default 
\emph default 
 Start lock manager stress test.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
ldlm_regress_stop
\series default 
\emph default 
 Stop lock manager stress test.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
dump_ldlm
\series default 
\emph default 
 Dump all lock manager state, this is very useful for debugging
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
newconn\SpecialChar ~
<olduuid>\SpecialChar ~
[newuuid]
\end_deeper 
\layout Description

Debug
\begin_deeper 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
debug_kernel\SpecialChar ~
[file]\SpecialChar ~
[raw]
\series default 
\emph default 
 Get debug buffer and dump to a 
\emph on 
fileusage
\emph default 
.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
debug_file\SpecialChar ~
<input>\SpecialChar ~
[output]\SpecialChar ~
[raw]
\series default 
\emph default 
 Read debug buffer from input and dump to 
\emph on 
outputusage
\emph default 
.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
clear
\series default 
\emph default 
 Clear kernel debug buffer.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
mark\SpecialChar ~
<text>
\series default 
\emph default 
 Insert marker text in kernel debug buffer.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
filter\SpecialChar ~
<subsystem\SpecialChar ~
id/debug\SpecialChar ~
mask>
\series default 
\emph default 
 Filter message type from the kernel debug buffer.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
show\SpecialChar ~
<subsystem\SpecialChar ~
id/debug\SpecialChar ~
mask>
\series default 
\emph default 
 Show specific type of messages.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
debug_list\SpecialChar ~
<subs/types>
\series default 
\emph default 
 List all the subsystem and debug types.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
panic
\series default 
\emph default 
 Force the kernel to panic.
\end_deeper 
\layout Description

Control
\begin_deeper 
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
help
\series default 
\emph default 
 Show a complete list of commands; 
\emph on 
help <command name>
\emph default 
 can be used to get help on specific command.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
exit
\series default 
\emph default 
 Close the lctl session.
\layout List
\labelwidthstring 00.00.0000


\series bold 
\emph on 
quit
\series default 
\emph default 
 Close the lctl session.
\end_deeper 
\layout Subsection

EXAMPLES
\layout Description


\emph on 
attach
\layout LyX-Code


\size small 
# lctl
\newline 
lctl > newdev
\newline 
lctl > attach obdfilter OBDDEV OBDUUID
\size default 

\newline 

\layout Description


\emph on 
connect
\layout LyX-Code


\size small 
lctl > name2dev OSCDEV
\newline 
2 
\newline 
lctl > device 2
\newline 
lctl > connect
\size default 

\newline 

\layout Description


\emph on 
getattr
\layout LyX-Code


\size small 
lctl > getattr 12
\newline 
id: 12
\newline 
grp: 0
\newline 
atime: 1002663714
\newline 
mtime: 1002663535
\newline 
ctime: 1002663535
\newline 
size: 10
\newline 
blocks: 8
\newline 
blksize: 4096
\newline 
mode: 100644
\newline 
uid: 0
\newline 
gid: 0
\newline 
flags: 0
\newline 
obdflags: 0
\newline 
nlink: 1
\newline 
valid: ffffffff
\newline 
inline:
\newline 
obdmd:
\newline 
lctl > disconnect 
\newline 
Finished (success)
\newline 

\layout Description


\emph on 
setup
\emph default 
 
\layout LyX-Code


\size small 
lctl > setup /dev/loop0 extN
\newline 
lctl > quit
\size default 

\newline 

\layout LyX-Code

\layout Subsection

BUGS
\layout Standard

None are known.
\the_end
