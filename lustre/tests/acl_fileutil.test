!
! Test for the patched file utilities.
!
$ umask 022
$ mkdir dir
$ acl_mode dir
drwxr-xr-x
$ touch dir/f
$ getfacl --omit-header dir/f
user::rw-
group::r--
other::r--

$ umask 027
$ cp -p dir/f dir/g
$ getfacl --omit-header dir/g
user::rw-
group::r--
other::r--

$ rm dir/g
$ cp dir/f dir/g
$ getfacl --omit-header dir/g
user::rw-
group::r--
other::---

$ setfacl -m u::rwx,u:joe:rwx,g::rwx,o::r-x dir/.
$ setfacl -dm u::rwx,u:joe:rwx,g::rwx,o::r-x dir/.
$ acl_mode dir
drwxrwxr-x+
$ touch dir/h
$ getfacl --omit-header --no-effective dir/h
user::rw-
user:joe:rwx
group::rwx
mask::r--
other::---

$ mkdir dir/d
$ getfacl --omit-header --no-effective dir/d
user::rwx
user:joe:rwx
group::rwx
mask::r-x
other::---
default:user::rwx
default:user:joe:rwx
default:group::rwx
default:mask::rwx
default:other::r-x

$ cp dir/f dir/i
$ getfacl --omit-header --no-effective dir/i
user::rw-
user:joe:rwx
group::rwx
mask::r--
other::---

$ acl_mode dir/f
-rw-r--r--
$ cp -p dir/f dir/j
$ acl_mode dir/j
-rw-r--r--
$ rm -r dir
