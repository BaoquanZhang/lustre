--- linux-2.5.69/drivers/Makefile.kernel-changes	Sun May  4 16:53:37 2003
+++ linux-2.5.69/drivers/Makefile	Mon Jun  2 17:39:46 2003
@@ -50,3 +50,4 @@
 obj-$(CONFIG_MCA)		+= mca/
 obj-$(CONFIG_EISA)		+= eisa/
 obj-$(CONFIG_CPU_FREQ)		+= cpufreq/
+obj-$(CONFIG_CRASH_DUMP)	+= dump/
--- linux-2.5.69/include/linux/major.h.kernel-changes	Sun May  4 16:53:08 2003
+++ linux-2.5.69/include/linux/major.h	Mon Jun  2 17:39:46 2003
@@ -156,6 +156,8 @@
 
 #define OSST_MAJOR		206	/* OnStream-SCx0 SCSI tape */
 
+#define CRASH_DUMP_MAJOR	221	/* crash dump interface */
+
 #define IBM_TTY3270_MAJOR	227
 #define IBM_FS3270_MAJOR	228
 
--- linux-2.5.69/include/linux/sysctl.h.kernel-changes	Sun May  4 16:53:31 2003
+++ linux-2.5.69/include/linux/sysctl.h	Mon Jun  2 17:39:46 2003
@@ -130,6 +130,8 @@
 	KERN_PIDMAX=55,		/* int: PID # limit */
   	KERN_CORE_PATTERN=56,	/* string: pattern for core-file names */
 	KERN_PANIC_ON_OOPS=57,  /* int: whether we will panic on an oops */
+
+	KERN_DUMP=60,		/* directory: dump parameters */
 };
 
 
--- linux-2.5.69/include/asm-i386/mach-default/irq_vectors.h.kernel-changes	Sun May  4 16:53:08 2003
+++ linux-2.5.69/include/asm-i386/mach-default/irq_vectors.h	Mon Jun  2 17:39:46 2003
@@ -48,6 +48,7 @@
 #define INVALIDATE_TLB_VECTOR	0xfd
 #define RESCHEDULE_VECTOR	0xfc
 #define CALL_FUNCTION_VECTOR	0xfb
+#define DUMP_VECTOR		0xfa
 
 #define THERMAL_APIC_VECTOR	0xf0
 /*
--- linux-2.5.69/include/asm-i386/kmap_types.h.kernel-changes	Sun May  4 16:53:36 2003
+++ linux-2.5.69/include/asm-i386/kmap_types.h	Mon Jun  2 17:39:46 2003
@@ -24,7 +24,8 @@
 D(11)	KM_IRQ1,
 D(12)	KM_SOFTIRQ0,
 D(13)	KM_SOFTIRQ1,
-D(14)	KM_TYPE_NR
+D(14)	KM_TYPE_NR,
+D(15)	KM_DUMP
 };
 
 #undef D
--- linux-2.5.69/include/asm-i386/smp.h.kernel-changes	Sun May  4 16:53:32 2003
+++ linux-2.5.69/include/asm-i386/smp.h	Mon Jun  2 17:39:46 2003
@@ -39,6 +39,7 @@
 extern int cpu_sibling_map[];
 
 extern void smp_flush_tlb(void);
+extern void dump_send_ipi(void);
 extern void smp_message_irq(int cpl, void *dev_id, struct pt_regs *regs);
 extern void smp_send_reschedule(int cpu);
 extern void smp_send_reschedule_all(void);
--- linux-2.5.69/arch/i386/kernel/i386_ksyms.c.kernel-changes	Sun May  4 16:53:57 2003
+++ linux-2.5.69/arch/i386/kernel/i386_ksyms.c	Mon Jun  2 17:39:46 2003
@@ -16,6 +16,7 @@
 #include <linux/tty.h>
 #include <linux/highmem.h>
 #include <linux/time.h>
+#include <linux/nmi.h>
 
 #include <asm/semaphore.h>
 #include <asm/processor.h>
@@ -33,6 +34,7 @@
 #include <asm/tlbflush.h>
 #include <asm/nmi.h>
 #include <asm/edd.h>
+#include <asm/e820.h>
 
 extern void dump_thread(struct pt_regs *, struct user *);
 extern spinlock_t rtc_lock;
@@ -211,3 +213,20 @@
 EXPORT_SYMBOL(edd);
 EXPORT_SYMBOL(eddnr);
 #endif
+
+#ifdef CONFIG_CRASH_DUMP_MODULE
+#ifdef CONFIG_SMP
+extern irq_desc_t irq_desc[NR_IRQS];
+extern unsigned long irq_affinity[NR_IRQS];
+extern void stop_this_cpu(void *);
+EXPORT_SYMBOL(irq_desc);
+EXPORT_SYMBOL(irq_affinity);
+EXPORT_SYMBOL(stop_this_cpu);
+EXPORT_SYMBOL(dump_send_ipi);
+#endif
+extern int pfn_is_ram(unsigned long);
+EXPORT_SYMBOL(pfn_is_ram);
+#ifdef ARCH_HAS_NMI_WATCHDOG
+EXPORT_SYMBOL(touch_nmi_watchdog);
+#endif
+#endif
--- linux-2.5.69/arch/i386/kernel/nmi.c.kernel-changes	Sun May  4 16:53:31 2003
+++ linux-2.5.69/arch/i386/kernel/nmi.c	Mon Jun  2 17:39:46 2003
@@ -23,6 +23,7 @@
 #include <linux/mc146818rtc.h>
 #include <linux/kernel_stat.h>
 #include <linux/module.h>
+#include <linux/dump.h>
 
 #include <asm/smp.h>
 #include <asm/mtrr.h>
@@ -404,6 +405,7 @@
 			bust_spinlocks(1);
 			printk("NMI Watchdog detected LOCKUP on CPU%d, eip %08lx, registers:\n", cpu, regs->eip);
 			show_registers(regs);
+			dump("NMI Watchdog detected LOCKUP", regs);
 			printk("console shuts up ...\n");
 			console_silent();
 			spin_unlock(&nmi_print_lock);
--- linux-2.5.69/arch/i386/kernel/setup.c.kernel-changes	Sun May  4 16:53:14 2003
+++ linux-2.5.69/arch/i386/kernel/setup.c	Mon Jun  2 17:39:46 2003
@@ -431,6 +431,7 @@
 	print_memory_map(who);
 } /* setup_memory_region */
 
+unsigned long crashdump_addr = 0xdeadbeef;
 
 static void __init parse_cmdline_early (char ** cmdline_p)
 {
@@ -520,6 +521,9 @@
 		if (c == ' ' && !memcmp(from, "highmem=", 8))
 			highmem_pages = memparse(from+8, &from) >> PAGE_SHIFT;
 	
+		if (c == ' ' && !memcmp(from, "crashdump=", 10))
+			crashdump_addr = memparse(from+10, &from); 
+			
 		c = *(from++);
 		if (!c)
 			break;
@@ -902,6 +906,8 @@
 
 __setup("noreplacement", noreplacement_setup); 
 
+extern void crashdump_reserve(void);
+
 void __init setup_arch(char **cmdline_p)
 {
 	unsigned long max_low_pfn;
@@ -959,6 +965,10 @@
 	smp_alloc_memory(); /* AP processor realmode stacks in low memory*/
 #endif
 	paging_init();
+
+#ifdef CONFIG_CRASH_DUMP_SOFTBOOT
+	crashdump_reserve(); /* Preserve crash dump state from prev boot */
+#endif
 #ifdef CONFIG_ACPI_BOOT
 	/*
 	 * Parse the ACPI tables for possible boot-time SMP configuration.
--- linux-2.5.69/arch/i386/kernel/smp.c.kernel-changes	Mon Jun  2 17:39:29 2003
+++ linux-2.5.69/arch/i386/kernel/smp.c	Mon Jun  2 17:39:46 2003
@@ -19,6 +19,7 @@
 #include <linux/mc146818rtc.h>
 #include <linux/cache.h>
 #include <linux/interrupt.h>
+#include <linux/dump.h>
 
 #include <asm/mtrr.h>
 #include <asm/pgalloc.h>
@@ -144,6 +145,13 @@
 	 */
 	cfg = __prepare_ICR(shortcut, vector);
 
+	if (vector == DUMP_VECTOR) {
+		/*
+		 * Setup DUMP IPI to be delivered as an NMI
+		 */
+		cfg = (cfg&~APIC_VECTOR_MASK)|APIC_DM_NMI;
+	}
+
 	/*
 	 * Send the IPI. The write to APIC_ICR fires this off.
 	 */
@@ -450,6 +458,11 @@
 	on_each_cpu(do_flush_tlb_all, 0, 1, 1);
 }
 
+void dump_send_ipi(void)
+{
+	send_IPI_allbutself(DUMP_VECTOR);
+}
+
 /*
  * this function sends a 'reschedule' IPI to another CPU.
  * it goes straight through and wastes no time serializing
@@ -574,4 +587,3 @@
 		atomic_inc(&call_data->finished);
 	}
 }
-
--- linux-2.5.69/arch/i386/kernel/traps.c.kernel-changes	Sun May  4 16:53:03 2003
+++ linux-2.5.69/arch/i386/kernel/traps.c	Mon Jun  2 17:39:46 2003
@@ -25,6 +25,7 @@
 #include <linux/highmem.h>
 #include <linux/kallsyms.h>
 #include <linux/ptrace.h>
+#include <linux/dump.h>
 
 #ifdef CONFIG_EISA
 #include <linux/ioport.h>
@@ -260,6 +261,7 @@
 	handle_BUG(regs);
 	printk("%s: %04lx [#%d]\n", str, err & 0xffff, ++die_counter);
 	show_registers(regs);
+	dump((char *)str, regs);
 	bust_spinlocks(0);
 	spin_unlock_irq(&die_lock);
 	if (in_interrupt())
--- linux-2.5.69/arch/i386/mm/init.c.kernel-changes	Sun May  4 16:53:36 2003
+++ linux-2.5.69/arch/i386/mm/init.c	Mon Jun  2 17:39:46 2003
@@ -188,6 +188,12 @@
 	return 0;
 }
 
+/* To enable modules to check if a page is in RAM */
+int pfn_is_ram(unsigned long pfn)
+{
+	return (page_is_ram(pfn));
+}
+
 #if CONFIG_HIGHMEM
 pte_t *kmap_pte;
 pgprot_t kmap_prot;
--- linux-2.5.69/arch/i386/boot/Makefile.kernel-changes	Sun May  4 16:53:13 2003
+++ linux-2.5.69/arch/i386/boot/Makefile	Mon Jun  2 17:39:46 2003
@@ -101,3 +101,4 @@
 
 install: $(BOOTIMAGE)
 	sh $(src)/install.sh $(KERNELRELEASE) $(BOOTIMAGE) System.map "$(INSTALL_PATH)"
+	if [ -f init/kerntypes.o ]; then cp init/kerntypes.o $(INSTALL_PATH)/Kerntypes; fi
--- linux-2.5.69/arch/i386/Kconfig.kernel-changes	Mon Jun  2 17:39:29 2003
+++ linux-2.5.69/arch/i386/Kconfig	Mon Jun  2 17:39:46 2003
@@ -1460,6 +1460,56 @@
 
 menu "Kernel hacking"
 
+config CRASH_DUMP
+	tristate "Crash dump support (EXPERIMENTAL)"
+	depends on EXPERIMENTAL
+	default n
+	---help---
+	  Say Y here to enable saving an image of system memory when a panic
+	  or other error occurs. Dumps can also be forced with the SysRq+d
+	  key if MAGIC_SYSRQ is enabled.
+
+config CRASH_DUMP_BLOCKDEV
+	tristate "Crash dump block device driver"
+	depends on CRASH_DUMP
+	help
+	  Say Y to allow saving crash dumps directly to a disk device.
+
+config CRASH_DUMP_NETDEV
+	tristate "Crash dump network device driver"
+	depends on CRASH_DUMP
+	help
+	  Say Y to allow saving crash dumps over a network device.
+
+config CRASH_DUMP_MEMDEV
+	bool "Crash dump staged memory driver"
+	depends on CRASH_DUMP
+	help
+	  Say Y to allow intermediate saving crash dumps in spare 
+	  memory pages which would then be written out to disk
+	  later.
+
+config CRASH_DUMP_SOFTBOOT
+	bool "Save crash dump across a soft reboot"
+	depends on CRASH_DUMP_MEMDEV
+	help
+	  Say Y to allow a crash dump to be preserved in memory
+	  pages across a soft reboot and written out to disk
+	  thereafter. For this to work, CRASH_DUMP must be 
+	  configured as part of the kernel (not as a module).
+
+config CRASH_DUMP_COMPRESS_RLE
+	tristate "Crash dump RLE compression"
+	depends on CRASH_DUMP
+	help
+	  Say Y to allow saving dumps with Run Length Encoding compression.
+
+config CRASH_DUMP_COMPRESS_GZIP
+	tristate "Crash dump GZIP compression"
+	depends on CRASH_DUMP
+	help
+	  Say Y to allow saving dumps with Gnu Zip compression.
+
 config DEBUG_KERNEL
 	bool "Kernel debugging"
 	help
--- linux-2.5.69/arch/s390/boot/Makefile.kernel-changes	Sun May  4 16:53:57 2003
+++ linux-2.5.69/arch/s390/boot/Makefile	Mon Jun  2 17:39:46 2003
@@ -16,4 +16,4 @@
 
 install: $(CONFIGURE) $(obj)/image
 	sh -x $(obj)/install.sh $(KERNELRELEASE) $(obj)/image \
-	      System.map Kerntypes "$(INSTALL_PATH)"
+	      System.map init/kerntypes.o "$(INSTALL_PATH)"
--- linux-2.5.69/arch/s390/boot/install.sh.kernel-changes	Sun May  4 16:53:32 2003
+++ linux-2.5.69/arch/s390/boot/install.sh	Mon Jun  2 17:39:46 2003
@@ -16,7 +16,8 @@
 #   $1 - kernel version
 #   $2 - kernel image file
 #   $3 - kernel map file
-#   $4 - default install path (blank if root directory)
+#   $4 - kernel type file
+#   $5 - default install path (blank if root directory)
 #
 
 # User may have a custom install script
@@ -26,13 +27,22 @@
 
 # Default install - same as make zlilo
 
-if [ -f $4/vmlinuz ]; then
-	mv $4/vmlinuz $4/vmlinuz.old
+if [ -f $5/vmlinuz ]; then
+	mv $5/vmlinuz $5/vmlinuz.old
 fi
 
-if [ -f $4/System.map ]; then
-	mv $4/System.map $4/System.old
+if [ -f $5/System.map ]; then
+	mv $5/System.map $5/System.old
 fi
 
-cat $2 > $4/vmlinuz
-cp $3 $4/System.map
+if [ -f $5/Kerntypes ]; then
+	mv $5/Kerntypes $5/Kerntypes.old
+fi
+
+cat $2 > $5/vmlinuz
+cp $3 $5/System.map
+
+# copy the kernel type file if it exists
+if [ -f $4 ]; then
+	cp $4 $5/Kerntypes
+fi
--- linux-2.5.69/scripts/mkcompile_h.kernel-changes	Sun May  4 16:53:57 2003
+++ linux-2.5.69/scripts/mkcompile_h	Mon Jun  2 17:39:46 2003
@@ -33,7 +33,7 @@
 
 UTS_LEN=64
 UTS_TRUNCATE="sed -e s/\(.\{1,$UTS_LEN\}\).*/\1/"
-
+LINUX_COMPILE_VERSION_ID="__linux_compile_version_id__`hostname | tr -c '[0-9A-Za-z\n]' '__'`_`LANG=C date | tr -c '[0-9A-Za-z\n]' '_'`"
 # Generate a temporary compile.h
 
 ( echo /\* This file is auto generated, version $VERSION \*/
@@ -55,6 +55,8 @@
   fi
 
   echo \#define LINUX_COMPILER \"`$CC -v 2>&1 | tail -1`\"
+  echo \#define LINUX_COMPILE_VERSION_ID $LINUX_COMPILE_VERSION_ID
+  echo \#define LINUX_COMPILE_VERSION_ID_TYPE typedef char* "$LINUX_COMPILE_VERSION_ID""_t"
 ) > .tmpcompile
 
 # Only replace the real compile.h if the new one is different,
--- linux-2.5.69/kernel/ksyms.c.kernel-changes	Sun May  4 16:52:49 2003
+++ linux-2.5.69/kernel/ksyms.c	Mon Jun  2 17:39:46 2003
@@ -60,6 +60,8 @@
 #include <linux/backing-dev.h>
 #include <linux/percpu_counter.h>
 #include <asm/checksum.h>
+#include <linux/dump.h>
+#include <linux/bootmem.h>
 
 #if defined(CONFIG_PROC_FS)
 #include <linux/proc_fs.h>
@@ -616,3 +618,9 @@
 EXPORT_SYMBOL(ptrace_notify);
 
 EXPORT_SYMBOL(current_kernel_time); 
+
+#ifdef CONFIG_CRASH_DUMP_MODULE
+EXPORT_SYMBOL(min_low_pfn);
+EXPORT_SYMBOL(dump_oncpu);
+EXPORT_SYMBOL(dump_function_ptr);
+#endif
--- linux-2.5.69/kernel/panic.c.kernel-changes	Mon Jun  2 17:39:29 2003
+++ linux-2.5.69/kernel/panic.c	Mon Jun  2 17:42:07 2003
@@ -16,12 +16,16 @@
 #include <linux/init.h>
 #include <linux/sysrq.h>
 #include <linux/interrupt.h>
+#ifdef CONFIG_KEXEC
+#include <linux/kexec.h>
+#endif
 
 asmlinkage void sys_sync(void);	/* it's really int */
 
 int panic_timeout;
 int panic_on_oops;
 int tainted;
+void (*dump_function_ptr)(const char *, const struct pt_regs *) = 0;
 
 struct notifier_block *panic_notifier_list;
 
@@ -54,6 +58,7 @@
 	va_start(args, fmt);
 	vsnprintf(buf, sizeof(buf), fmt, args);
 	va_end(args);
+
 	printk(KERN_EMERG "Kernel panic: %s\n",buf);
 	if (in_interrupt())
 		printk(KERN_EMERG "In interrupt handler - not syncing\n");
@@ -76,6 +81,18 @@
 		 * We can't use the "normal" timers since we just panicked..
 	 	 */
 		printk(KERN_EMERG "Rebooting in %d seconds..",panic_timeout);
+#ifdef CONFIG_KEXEC
+{
+		struct kimage *image;
+		image = xchg(&kexec_image, 0);
+		if (image) {
+			printk(KERN_EMERG "by starting a new kernel ..\n");
+			mdelay(panic_timeout*1000);
+			machine_kexec(image);
+		}
+}
+#endif
+
 		mdelay(panic_timeout*1000);
 		/*
 		 *	Should we run the reboot notifier. For the moment Im
--- linux-2.5.69/kernel/sched.c.kernel-changes	Sun May  4 16:53:37 2003
+++ linux-2.5.69/kernel/sched.c	Mon Jun  2 17:39:46 2003
@@ -39,6 +39,9 @@
 #define cpu_to_node_mask(cpu) (cpu_online_map)
 #endif
 
+/* used to soft spin in sched while dump is in progress */
+int dump_oncpu;
+
 /*
  * Convert user-nice values [ -20 ... 0 ... 19 ]
  * to static priority [ MAX_RT_PRIO..MAX_PRIO-1 ],
@@ -1267,6 +1270,15 @@
 	struct list_head *queue;
 	int idx;
 
+ 	/*
+	 * If crash dump is in progress, this other cpu's
+	 * need to wait until it completes.
+	 * NB: this code is optimized away for kernels without
+	 * dumping enabled.
+	 */
+	if (unlikely(dump_oncpu))
+		goto dump_scheduling_disabled;
+
 	/*
 	 * Test if we are atomic.  Since do_exit() needs to call into
 	 * schedule() atomically, we ignore that path for now.
@@ -1355,6 +1367,16 @@
 	preempt_enable_no_resched();
 	if (test_thread_flag(TIF_NEED_RESCHED))
 		goto need_resched;
+
+	return;
+
+ dump_scheduling_disabled:
+	/* allow scheduling only if this is the dumping cpu */
+	if (dump_oncpu != smp_processor_id()+1) {
+		while (dump_oncpu)
+			cpu_relax();
+	}
+	return;
 }
 
 #ifdef CONFIG_PREEMPT
--- linux-2.5.69/lib/Kconfig.kernel-changes	Sun May  4 16:53:32 2003
+++ linux-2.5.69/lib/Kconfig	Mon Jun  2 17:39:46 2003
@@ -17,14 +17,16 @@
 #
 config ZLIB_INFLATE
 	tristate
-	default y if CRAMFS=y || PPP_DEFLATE=y || JFFS2_FS=y || ZISOFS_FS=y || BINFMT_ZFLAT=y || CRYPTO_DEFLATE=y
-	default m if CRAMFS=m || PPP_DEFLATE=m || JFFS2_FS=m || ZISOFS_FS=m || BINFMT_ZFLAT=m || CRYPTO_DEFLATE=m
+	default y if CRAMFS=y || PPP_DEFLATE=y || JFFS2_FS=y || ZISOFS_FS=y || BINFMT_ZFLAT=y || CRYPTO_DEFLATE=y || CRASH_DUMP_COMPRESS_GZIP=y
+	default m if CRAMFS=m || PPP_DEFLATE=m || JFFS2_FS=m || ZISOFS_FS=m || BINFMT_ZFLAT=m || CRYPTO_DEFLATE=m || CRASH_DUMP_COMPRESS_GZIP=m
 
 config ZLIB_DEFLATE
 	tristate
 	default m if PPP_DEFLATE!=y && JFFS2_FS!=y && CRYPTO_DEFLATE!=y && \
-		(PPP_DEFLATE=m || JFFS2_FS=m || CRYPTO_DEFLATE=m)
-	default y if PPP_DEFLATE=y || JFFS2_FS=y || CRYPTO_DEFLATE=y
+		(PPP_DEFLATE=m || JFFS2_FS=m || CRYPTO_DEFLATE=m \
+			|| CRASH_DUMP_COMPRESS_GZIP=m )
+	default y if PPP_DEFLATE=y || JFFS2_FS=y || CRYPTO_DEFLATE=y \
+		|| CRASH_DUMP_COMPRESS_GZIP=y
 
 endmenu
 
--- linux-2.5.69/mm/page_alloc.c.kernel-changes	Sun May  4 16:53:01 2003
+++ linux-2.5.69/mm/page_alloc.c	Mon Jun  2 17:39:46 2003
@@ -85,7 +85,8 @@
 	page->mapping = NULL;
 }
 
-#ifndef CONFIG_HUGETLB_PAGE
+#if !defined(CONFIG_HUGETLB_PAGE) && !defined(CONFIG_CRASH_DUMP) \
+	&& !defined(CONFIG_CRASH_DUMP_MODULE)
 #define prep_compound_page(page, order) do { } while (0)
 #define destroy_compound_page(page, order) do { } while (0)
 #else
--- linux-2.5.69/init/Makefile.kernel-changes	Sun May  4 16:53:13 2003
+++ linux-2.5.69/init/Makefile	Mon Jun  2 17:39:46 2003
@@ -9,6 +9,9 @@
 mounts-$(CONFIG_BLK_DEV_INITRD)	+= do_mounts_initrd.o
 mounts-$(CONFIG_BLK_DEV_MD)	+= do_mounts_md.o
 
+extra-$(CONFIG_CRASH_DUMP)	+= kerntypes.o
+CFLAGS_kerntypes.o		:= -gstabs
+
 # files to be removed upon make clean
 clean-files := ../include/linux/compile.h
 
@@ -24,3 +27,4 @@
 include/linux/compile.h: FORCE
 	@echo '  CHK     $@'
 	@sh $(srctree)/scripts/mkcompile_h $@ "$(UTS_MACHINE)" "$(CONFIG_SMP)" "$(CC) $(CFLAGS)"
+
--- linux-2.5.69/init/main.c.kernel-changes	Sun May  4 16:53:03 2003
+++ linux-2.5.69/init/main.c	Mon Jun  2 17:39:46 2003
@@ -100,6 +100,16 @@
 int system_running = 0;
 
 /*
+ * The kernel_magic value represents the address of _end, which allows
+ * namelist tools to "match" each other respectively.  That way a tool
+ * that looks at /dev/mem can verify that it is using the right System.map
+ * file -- if kernel_magic doesn't equal the namelist value of _end,
+ * something's wrong.
+ */
+extern unsigned long _end;
+unsigned long *kernel_magic = &_end;
+
+/*
  * Boot command-line arguments
  */
 #define MAX_INIT_ARGS 8
--- linux-2.5.69/init/version.c.kernel-changes	Sun May  4 16:53:14 2003
+++ linux-2.5.69/init/version.c	Mon Jun  2 17:39:46 2003
@@ -10,6 +10,7 @@
 #include <linux/uts.h>
 #include <linux/utsname.h>
 #include <linux/version.h>
+#include <linux/stringify.h>
 
 #define version(a) Version_ ## a
 #define version_string(a) version(a)
@@ -24,3 +25,6 @@
 const char *linux_banner = 
 	"Linux version " UTS_RELEASE " (" LINUX_COMPILE_BY "@"
 	LINUX_COMPILE_HOST ") (" LINUX_COMPILER ") " UTS_VERSION "\n";
+
+const char *LINUX_COMPILE_VERSION_ID = __stringify(LINUX_COMPILE_VERSION_ID);
+LINUX_COMPILE_VERSION_ID_TYPE;
