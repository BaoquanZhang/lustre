 fs/ext3/namei.c |    2 +-
 1 files changed, 1 insertion(+), 1 deletion(-)

diff -puN fs/ext3/namei.c~ext3-compat-2.4.18-chaos fs/ext3/namei.c
--- linux-2.4.18/fs/ext3/namei.c~ext3-compat-2.4.18-chaos	2003-08-28 20:14:27.000000000 +0400
+++ linux-2.4.18-alexey/fs/ext3/namei.c	2003-08-28 20:14:27.000000000 +0400
@@ -830,9 +830,9 @@ static int ext3_rmdir (struct inode * di
 	 * recovery. */
 	inode->i_size = 0;
 	ext3_orphan_add(handle, inode);
-	ext3_mark_inode_dirty(handle, inode);
 	dir->i_nlink--;
 	inode->i_ctime = dir->i_ctime = dir->i_mtime = CURRENT_TIME;
+	ext3_mark_inode_dirty(handle, inode);
 	dir->u.ext3_i.i_flags &= ~EXT3_INDEX_FL;
 	ext3_mark_inode_dirty(handle, dir);
 

_
