 fs/ext3/namei.c |    3 ++-
 lib/rbtree.c    |    6 +++---
 2 files changed, 5 insertions(+), 4 deletions(-)

--- linux-2.4.18-chaos-pdirops/fs/ext3/namei.c~ext3-compat-2.4.18-chaos	2003-09-23 13:13:10.000000000 +0400
+++ linux-2.4.18-chaos-pdirops-alexey/fs/ext3/namei.c	2003-09-23 13:13:28.000000000 +0400
@@ -28,6 +28,7 @@
 #include <linux/string.h>
 #include <linux/locks.h>
 #include <linux/quotaops.h>
+#include <linux/slab.h>
 
 
 /*
@@ -830,9 +831,9 @@ static int ext3_rmdir (struct inode * di
 	 * recovery. */
 	inode->i_size = 0;
 	ext3_orphan_add(handle, inode);
-	ext3_mark_inode_dirty(handle, inode);
 	dir->i_nlink--;
 	inode->i_ctime = dir->i_ctime = dir->i_mtime = CURRENT_TIME;
+	ext3_mark_inode_dirty(handle, inode);
 	dir->u.ext3_i.i_flags &= ~EXT3_INDEX_FL;
 	ext3_mark_inode_dirty(handle, dir);
 
--- linux-2.4.18-chaos-pdirops/lib/rbtree.c~ext3-compat-2.4.18-chaos	2003-07-28 17:52:20.000000000 +0400
+++ linux-2.4.18-chaos-pdirops-alexey/lib/rbtree.c	2003-09-23 13:13:15.000000000 +0400
@@ -219,6 +219,8 @@ static void __rb_erase_color(rb_node_t *
 		node->rb_color = RB_BLACK;
 }
 
+EXPORT_SYMBOL_GPL(rb_insert_color);
+
 void rb_erase(rb_node_t * node, rb_root_t * root)
 {
 	rb_node_t * child, * parent;
@@ -292,6 +294,4 @@ void rb_erase(rb_node_t * node, rb_root_
 	if (color == RB_BLACK)
 		__rb_erase_color(child, parent, root);
 }
-
-EXPORT_SYMBOL_GPL(rb_insert_color);
-EXPORT_SYMBOL_GPL(rb_erase);
+EXPORT_SYMBOL(rb_erase);

_
